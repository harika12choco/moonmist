<!DOCTYPE html>
<html>
<head>
<title>Moon Mist | Cart</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
<style>
body { font-family:Poppins, sans-serif; background:#f5eee9; padding:40px; color:#4e3b31; }
.cart-container { max-width:700px; margin:auto; background:#fff7f2; padding:25px; border-radius:20px; box-shadow:0 10px 25px rgba(0,0,0,0.1);}
h2{text-align:center; margin-bottom:20px;}
.item{display:flex; justify-content:space-between; padding:12px 0; border-bottom:1px solid #decfc7; align-items:center;}
.item button{background:#cc8f72; color:white; border:none; padding:5px 10px; border-radius:5px; cursor:pointer; font-size:14px;}
.item button:hover{background:#b3705a;}
.total{margin-top:20px; font-size:20px; font-weight:600; text-align:right; color:#a85a5a;}
.empty{text-align:center; color:#888; margin-top:30px; font-size:18px;}
form{margin-top:20px; display:flex; flex-direction:column; gap:15px;}
form input, form textarea{padding:10px; border-radius:6px; border:1px solid #ccc; font-size:16px; width:100%;}
form label{font-weight:500;}
.checkout-btn{display:block; width:100%; background:#a85a5a; color:white; padding:12px; border:none; border-radius:28px; font-weight:600; cursor:pointer;}
.checkout-btn:hover{background:#914444;}
#prebill {margin-top:20px; background:#fff3e0; padding:15px; border-radius:10px; box-shadow:0 4px 6px rgba(0,0,0,0.1);}
#prebill h3{margin-top:0;}
#confirmation {margin-top:15px; background:#4BB543; color:white; padding:12px; border-radius:8px; text-align:center; display:none;}
</style>
</head>
<body>

<div class="cart-container">
<h2>Your Cart</h2>
<div id="cart-items"></div>
<div class="total" id="totalAmount">Total: â‚¹0</div>

<form id="orderForm">
<label for="name">Full Name</label>
<input type="text" id="name" placeholder="Enter your full name" required>

<label for="phone">Phone Number</label>
<input type="tel" id="phone" placeholder="Enter your phone number" required>

<label for="address">Delivery Address</label>
<textarea id="address" placeholder="Enter your address" rows="3" required></textarea>

<button type="submit" class="checkout-btn">Place Order via WhatsApp</button>
</form>

<!-- Pre-bill display -->
<div id="prebill" style="display:none;"></div>
<!-- Confirmation message -->
<div id="confirmation">âœ” Please send the WhatsApp message to place your order. Once sent, your order will be processed via COD.</div>

</div>

<script>
let cart = JSON.parse(localStorage.getItem("cart")) || [];

// Load cart items
function loadCart() {
  const container = document.getElementById("cart-items");
  container.innerHTML = "";
  let total = 0;

  if(cart.length === 0) {
    container.innerHTML = '<div class="empty">Your cart is empty!</div>';
    document.getElementById("totalAmount").innerText = "Total: â‚¹0";
    return;
  }

  cart.forEach((item, index) => {
    total += item.price;
    const div = document.createElement("div");
    div.classList.add("item");
    div.innerHTML = `
      <span>${item.name}</span>
      <span>â‚¹${item.price}</span>
      <button onclick="removeItem(${index})">Remove</button>
    `;
    container.appendChild(div);
  });

  document.getElementById("totalAmount").innerText = "Total: â‚¹" + total;
}

// Remove item
function removeItem(index){
  cart.splice(index, 1);
  localStorage.setItem("cart", JSON.stringify(cart));
  loadCart();
}

loadCart();

// Handle order form
document.getElementById("orderForm").addEventListener("submit", function(e){
  e.preventDefault();

  if(cart.length === 0){
    alert("Cart is empty!");
    return;
  }

  const name = document.getElementById("name").value.trim();
  const phone = document.getElementById("phone").value.trim();
  const address = document.getElementById("address").value.trim();

  if(!name || !phone || !address){
    alert("Please fill all details");
    return;
  }

  let total = cart.reduce((sum, item) => sum + item.price, 0);

  // Build pre-bill HTML
  let prebillHTML = `<h3>Pre-Bill</h3>`;
  prebillHTML += `<p><strong>Name:</strong> ${name}<br>`;
  prebillHTML += `<strong>Phone:</strong> ${phone}<br>`;
  prebillHTML += `<strong>Address:</strong> ${address}</p>`;
  prebillHTML += `<p><strong>Items:</strong></p><ul>`;
  cart.forEach(i => { prebillHTML += `<li>${i.name} - â‚¹${i.price}</li>`; });
  prebillHTML += `</ul>`;
  prebillHTML += `<p><strong>Total Amount:</strong> â‚¹${total}</p>`;
  prebillHTML += `<p><strong>Payment Method:</strong> COD</p>`;
  document.getElementById("prebill").innerHTML = prebillHTML;
  document.getElementById("prebill").style.display = "block";

  // WhatsApp message
  let message = `ðŸ•¯ï¸ *Moon Mist Order* ðŸ•¯ï¸%0A%0A`;
  message += `*Name:* ${name}%0A`;
  message += `*Phone:* ${phone}%0A`;
  message += `*Address:* ${address}%0A%0A`;
  message += `*Order Details:*%0A`;
  cart.forEach(i => { message += `â€¢ ${i.name} - â‚¹${i.price}%0A`; });
  message += `%0A*Total Amount:* â‚¹${total}%0A`;
  message += `%0APayment Method: COD%0A`;
  message += `%0APlease confirm availability.`;

  // Open WhatsApp
  window.open("https://wa.me/91XXXXXXXXXX?text=" + message, "_blank");

  // Clear cart
  localStorage.removeItem("cart");
  cart = [];
  loadCart();

  // Show confirmation message
  const confirmDiv = document.getElementById("confirmation");
  confirmDiv.style.display = "block";
  setTimeout(() => { confirmDiv.style.display = "none"; }, 8000);
});
</script>

</body>
</html>

